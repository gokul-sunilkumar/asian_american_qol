# Results

```{r}
library(dplyr)
library(gridExtra)
library(naniar)
```

```{r}
# Missing Value Analysis

# Plot 1
missing.values <- data %>%
  gather(key = "key", value = "val") %>%
  mutate(isna = is.na(val)) %>%
  group_by(key) %>%
  mutate(total = n()) %>%
  group_by(key, total, isna) %>%
  summarise(num.isna = n()) %>%
  mutate(pct = num.isna / total * 100)


levels <-
    (missing.values  %>% filter(isna == T, pct>4) %>% arrange(desc(pct)))$key

percentage.plot <- missing.values %>% filter(key %in% levels) %>% 
      ggplot() +
        geom_bar(aes(x = reorder(key, desc(pct)), 
                     y = pct, fill=isna), 
                 stat = 'identity', alpha=0.8) +
      scale_x_discrete(limits = levels) +
      scale_fill_manual(name = "", 
                        values = c('steelblue', 'tomato3'), labels = c("Present", "Missing")) +
      coord_flip() +
      labs(title = "Percentage of missing values", x =
             'Feature', y = "% of missing values")

percentage.plot
```

```{r}
# Plot 2
row.plot <- data[levels] %>%  
  mutate(id = row_number()) %>%
  gather(-id, key = "key", value = "val") %>%
  mutate(isna = is.na(val)) %>%
  ggplot(aes(key, id, fill = isna)) +
    geom_raster(alpha=0.8) +
    scale_fill_manual(name = "",
        values = c('steelblue', 'tomato3'),
        labels = c("Present", "Missing")) +
    scale_x_discrete(limits = levels) +
    labs(x = "Feature",
           y = "Row Number", title = "Missing values in rows") +
    coord_flip()

row.plot

```
```{r}
gg_miss_fct(x = data[levels] %>% subset(Occupation != 0) , fct = Occupation)
```

```{r}
gg_miss_fct(x = data[levels] %>% drop_na("Income") , fct = Income)
```


