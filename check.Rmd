

```{r}
# missing.values <- read.csv("/Users/gokul/Documents/R Programs/asian_american_qol/data/missing.csv")
missing.values <- data %>%
  tidyr::gather(key = "key", value = "val") %>%
  dplyr::mutate(isna = is.na(val)) %>%
  group_by(key) %>%
  mutate(total = n()) %>%
  group_by(key, total, isna) %>%
  summarise(num.isna = n()) %>%
  mutate(pct = num.isna / total * 100)

levels <-
    (missing.values  %>% dplyr::filter(isna == T, pct>4) %>% arrange(desc(pct)))$key

percentage.plot <- missing.values %>% dplyr::filter(key %in% levels) %>% 
      ggplot() +
        geom_bar(aes(x = reorder(key, desc(pct)), 
                     y = pct, fill=isna), 
                 stat = 'identity', alpha=0.8) +
      scale_x_discrete(limits = levels) +
      scale_fill_manual(name = "", 
                        values = c('steelblue', 'tomato3'), labels = c("Present", "Missing")) +
      coord_flip() +
      labs(title = "Percentage of missing values", x =
             'Feature', y = "% of missing values")

percentage.plot
```

